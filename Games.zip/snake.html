<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>贪吃蛇 - Snake</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background:#ffffff;
  font-family:'Noto Sans SC',sans-serif;
  padding:1rem;
}

.back-link{
  position:fixed;
  top:1rem;
  left:1rem;
  color:#666;
  text-decoration:none;
  font-size:0.9rem;
}

.back-link:hover{color:#ff8f00;}

.game-container{
  background:#fff;
  padding:2rem;
  border-radius:20px;
  border:1px solid #eee;
  box-shadow:0 4px 20px rgba(0,0,0,0.08);
  text-align:center;
}

h1{
  font-size:1.8rem;
  margin-bottom:0.5rem;
  background:linear-gradient(90deg,#ff8f00,#ffeb3b);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.score{
  margin-bottom:1rem;
  font-family:'JetBrains Mono',monospace;
  font-weight:600;
}

canvas{
  background:#f5f5f5;
  border-radius:12px;
  border:2px solid #eee;
}

button{
  margin-top:1rem;
  padding:0.6rem 1.2rem;
  border:none;
  border-radius:10px;
  background:linear-gradient(135deg,#ff8f00,#ffeb3b);
  font-weight:600;
  cursor:pointer;
}

.game-over{
  margin-top:1rem;
  font-weight:600;
  color:#c62828;
}

.controls{
  margin-top:1rem;
  font-size:0.85rem;
  color:#666;
}
</style>
</head>

<body>

<a href="index.html" class="back-link">← 返回游戏列表</a>

<div class="game-container">
  <h1>贪吃蛇</h1>
  <div class="score">分数: <span id="score">0</span></div>
  <canvas id="game" width="400" height="400"></canvas>
  <div class="game-over" id="gameOver"></div>
  <button onclick="init()">重新开始</button>
  <div class="controls">使用 ↑ ↓ ← → 控制方向</div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const gridSize = 20;
const tileCount = canvas.width / gridSize;

let snake, food, dx, dy, score, gameInterval, gameOver, started;

function init(){
  snake = [{x:10,y:10}];
  dx = 0;
  dy = 0;
  score = 0;
  gameOver = false;
  started = false;

  document.getElementById("score").textContent = score;
  document.getElementById("gameOver").textContent = "";

  placeFood();

  if(gameInterval) clearInterval(gameInterval);
  gameInterval = setInterval(gameLoop, 120);

  draw();
}

function placeFood(){
  do{
    food = {
      x: Math.floor(Math.random()*tileCount),
      y: Math.floor(Math.random()*tileCount)
    };
  }while(snake.some(seg => seg.x===food.x && seg.y===food.y));
}

function gameLoop(){
  if(gameOver || !started) return;

  const head = {x: snake[0].x + dx, y: snake[0].y + dy};

  // 撞墙
  if(head.x < 0 || head.x >= tileCount ||
     head.y < 0 || head.y >= tileCount){
    endGame();
    return;
  }

  // 撞自己
  if(snake.some(seg => seg.x===head.x && seg.y===head.y)){
    endGame();
    return;
  }

  snake.unshift(head);

  if(head.x === food.x && head.y === food.y){
    score++;
    document.getElementById("score").textContent = score;
    placeFood();
  }else{
    snake.pop();
  }

  draw();
}

function draw(){
  ctx.fillStyle="#f5f5f5";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="#ff7043";
  ctx.fillRect(food.x*gridSize, food.y*gridSize, gridSize-2, gridSize-2);

  ctx.fillStyle="#43a047";
  snake.forEach(seg=>{
    ctx.fillRect(seg.x*gridSize, seg.y*gridSize, gridSize-2, gridSize-2);
  });
}

function endGame(){
  gameOver = true;
  document.getElementById("gameOver").textContent="游戏结束！";
}

document.addEventListener("keydown", e=>{
  if(gameOver) return;

  if(!started){
    started = true;
  }

  if(e.key==="ArrowUp" && dy===0){ dx=0; dy=-1; }
  if(e.key==="ArrowDown" && dy===0){ dx=0; dy=1; }
  if(e.key==="ArrowLeft" && dx===0){ dx=-1; dy=0; }
  if(e.key==="ArrowRight" && dx===0){ dx=1; dy=0; }
});

init();
</script>

</body>
</html>
