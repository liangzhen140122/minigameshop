<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>井字棋</title>

<style>
body{
  font-family: Arial, sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  background:#f5f5f5;
}

.back-link{
  position:fixed;
  top:20px;
  left:20px;
  text-decoration:none;
  color:#333;
  font-weight:bold;
}

h1{margin-bottom:20px;}

.mode-select{
  display:flex;
  gap:20px;
  margin-bottom:20px;
}

button{
  padding:10px 20px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  background:#4caf50;
  color:white;
}

.board{
  display:grid;
  grid-template-columns:repeat(3,100px);
  gap:10px;
  margin-top:20px;
}

.cell{
  width:100px;
  height:100px;
  background:white;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:40px;
  font-weight:bold;
  cursor:pointer;
  border-radius:8px;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
}

.status{
  margin-top:15px;
  font-weight:bold;
}
</style>
</head>

<body>

<a href="index.html" class="back-link">← 返回游戏列表</a>

<h1>井字棋</h1>

<div class="mode-select" id="modeSelect">
  <button onclick="startGame('pvp')">双人对局</button>
  <button onclick="startGame('ai')">人类 vs AI</button>
</div>

<div class="board" id="board" style="display:none;"></div>

<div class="status" id="status"></div>

<button onclick="resetGame()" style="margin-top:15px;">重新开始</button>

<script>
let board=[];
let currentPlayer="X";
let gameMode="pvp";
let gameActive=false;

const winPatterns=[
  [0,1,2],[3,4,5],[6,7,8],
  [0,3,6],[1,4,7],[2,5,8],
  [0,4,8],[2,4,6]
];

const boardEl=document.getElementById("board");
const statusEl=document.getElementById("status");

function startGame(mode){
  gameMode=mode;
  document.getElementById("modeSelect").style.display="none";
  boardEl.style.display="grid";
  init();
}

function init(){
  board=["","","","","","","","",""];
  currentPlayer="X";
  gameActive=true;
  boardEl.innerHTML="";
  statusEl.textContent="当前玩家: X";

  for(let i=0;i<9;i++){
    const cell=document.createElement("div");
    cell.className="cell";
    cell.onclick=()=>handleClick(i);
    boardEl.appendChild(cell);
  }
}

function handleClick(index){
  if(!gameActive || board[index]!="") return;

  makeMove(index,currentPlayer);

  if(gameMode==="ai" && gameActive && currentPlayer==="O"){
    setTimeout(aiMove,400);
  }
}

function makeMove(index,player){
  board[index]=player;
  boardEl.children[index].textContent=player;

  if(checkWin(player)){
    statusEl.textContent=player+" 获胜!";
    gameActive=false;
    return;
  }

  if(board.every(cell=>cell!="")){
    statusEl.textContent="平局!";
    gameActive=false;
    return;
  }

  currentPlayer = player==="X"?"O":"X";
  statusEl.textContent="当前玩家: "+currentPlayer;
}

function checkWin(player){
  return winPatterns.some(pattern=>{
    return pattern.every(i=>board[i]===player);
  });
}

function aiMove(){
  let emptyIndexes=board
    .map((v,i)=>v===""?i:null)
    .filter(v=>v!==null);

  if(emptyIndexes.length===0) return;

  const randomIndex=emptyIndexes[Math.floor(Math.random()*emptyIndexes.length)];
  makeMove(randomIndex,"O");
}

function resetGame(){
  document.getElementById("modeSelect").style.display="flex";
  boardEl.style.display="none";
  statusEl.textContent="";
}
</script>

</body>
</html>