<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Êâ´Èõ∑ - Minesweeper Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
  font-family:'Noto Sans SC',sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  background:linear-gradient(135deg,#e3f2fd,#ffffff);
}

.back-link{
  position:fixed; top:1rem; left:1rem;
  text-decoration:none; color:#666;
}
.back-link:hover{color:#ff8f00;}

.game{
  background:white;
  padding:20px;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.1);
  text-align:center;
}

.top-bar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:15px;
  background:#f5f5f5;
  padding:10px 15px;
  border-radius:12px;
  font-weight:bold;
}

#face{
  cursor:pointer;
  font-size:22px;
}

.board{
  display:grid;
  grid-template-columns:repeat(9,38px);
  gap:4px;
}

.cell{
  width:38px;height:38px;
  background:#dce3ea;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  cursor:pointer;
  user-select:none;
  transition:0.15s;
}

.cell:hover{ background:#cfd8dc; }

.cell.open{
  background:#f1f5f9;
  cursor:default;
}

.cell.mine{
  background:#ef5350;
  color:white;
}

.flag{ color:#ff5252; }

.num1{color:#1976d2;}
.num2{color:#388e3c;}
.num3{color:#d32f2f;}
.num4{color:#7b1fa2;}
.num5{color:#ff8f00;}
.num6{color:#00838f;}
.num7{color:#5d4037;}
.num8{color:#455a64;}
</style>
</head>

<body>

<a href="index.html" class="back-link">‚Üê ËøîÂõû</a>

<div class="game">
  <div class="top-bar">
    <div>üí£ <span id="mineCount">10</span></div>
    <div id="face">üôÇ</div>
    <div>‚è± <span id="timer">0</span></div>
  </div>
  <div id="board" class="board"></div>
</div>

<script>
const size=9;
const minesTotal=10;

let board=[];
let gameOver=false;
let firstClick=true;
let timer=0;
let interval=null;
let flags=0;

function init(){
  board=[];
  gameOver=false;
  firstClick=true;
  timer=0;
  flags=0;
  document.getElementById("timer").textContent=0;
  document.getElementById("mineCount").textContent=minesTotal;
  document.getElementById("face").textContent="üôÇ";
  clearInterval(interval);

  for(let r=0;r<size;r++){
    board[r]=[];
    for(let c=0;c<size;c++){
      board[r][c]={mine:false,open:false,count:0,flag:false};
    }
  }
  render();
}

function placeMines(excludeR,excludeC){
  let placed=0;
  while(placed<minesTotal){
    let r=Math.floor(Math.random()*size);
    let c=Math.floor(Math.random()*size);
    if((r===excludeR&&c===excludeC)||board[r][c].mine) continue;
    board[r][c].mine=true;
    placed++;
  }

  for(let r=0;r<size;r++){
    for(let c=0;c<size;c++){
      if(board[r][c].mine) continue;
      let count=0;
      for(let dr=-1;dr<=1;dr++){
        for(let dc=-1;dc<=1;dc++){
          let nr=r+dr,nc=c+dc;
          if(nr>=0&&nr<size&&nc>=0&&nc<size&&board[nr][nc].mine) count++;
        }
      }
      board[r][c].count=count;
    }
  }
}

function render(){
  const boardEl=document.getElementById("board");
  boardEl.innerHTML="";
  for(let r=0;r<size;r++){
    for(let c=0;c<size;c++){
      const cell=document.createElement("div");
      cell.className="cell";

      const data=board[r][c];

      if(data.open){
        cell.classList.add("open");
        if(data.mine){
          cell.classList.add("mine");
          cell.textContent="üí£";
        }else if(data.count>0){
          cell.textContent=data.count;
          cell.classList.add("num"+data.count);
        }
      }else if(data.flag){
        cell.textContent="üö©";
        cell.classList.add("flag");
      }

      cell.oncontextmenu=(e)=>{
        e.preventDefault();
        toggleFlag(r,c);
      }

      cell.onclick=()=>openCell(r,c);

      boardEl.appendChild(cell);
    }
  }
}

function openCell(r,c){
  if(gameOver||board[r][c].open||board[r][c].flag) return;

  if(firstClick){
    placeMines(r,c);
    startTimer();
    firstClick=false;
  }

  board[r][c].open=true;

  if(board[r][c].mine){
    revealAll();
    document.getElementById("face").textContent="üòµ";
    gameOver=true;
    return;
  }

  if(board[r][c].count===0){
    for(let dr=-1;dr<=1;dr++){
      for(let dc=-1;dc<=1;dc++){
        let nr=r+dr,nc=c+dc;
        if(nr>=0&&nr<size&&nc>=0&&nc<size){
          if(!board[nr][nc].open) openCell(nr,nc);
        }
      }
    }
  }

  checkWin();
  render();
}

function toggleFlag(r,c){
  if(gameOver||board[r][c].open) return;
  board[r][c].flag=!board[r][c].flag;
  flags+=board[r][c].flag?1:-1;
  document.getElementById("mineCount").textContent=minesTotal-flags;
  render();
}

function revealAll(){
  for(let r=0;r<size;r++)
    for(let c=0;c<size;c++)
      board[r][c].open=true;
  render();
}

function checkWin(){
  let opened=0;
  for(let r=0;r<size;r++)
    for(let c=0;c<size;c++)
      if(board[r][c].open) opened++;

  if(opened===size*size-minesTotal){
    document.getElementById("face").textContent="üòé";
    gameOver=true;
    clearInterval(interval);
  }
}

function startTimer(){
  interval=setInterval(()=>{
    timer++;
    document.getElementById("timer").textContent=timer;
  },1000);
}

document.getElementById("face").onclick=init;

init();
</script>

</body>
</html>